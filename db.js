// Generated by CoffeeScript 1.4.0
(function() {
  var mydb, resultsFromResultSet, showLogs, spanishLog;

  if (window.openDatabase) {
    mydb = openDatabase("spanish_verbs_db", "0.1", "Spanish verbs", 4 * 1024 * 1024);
    mydb.transaction(function(t) {
      return t.executeSql("CREATE TABLE IF NOT EXISTS logs (id INTEGER PRIMARY KEY ASC, properties TEXT, time INTEGER)");
    });
  } else {
    alert("WebSQL is not supported by your browser!");
  }

  resultsFromResultSet = function(resultSet) {
    var i, r;
    i = 0;
    r = [];
    while (i < resultSet.rows.length) {
      r.push(resultSet.rows.item(i));
      i++;
    }
    return r;
  };

  showLogs = function(setResults) {
    return mydb.transaction(function(t) {
      return t.executeSql("SELECT * FROM logs order by time", [], function(transaction, results) {
        return setResults(resultsFromResultSet(results));
      });
    });
  };

  spanishLog = function(properties, timestamp, setResults) {
    return mydb.transaction(function(t) {
      t.executeSql("INSERT INTO logs (properties, time) VALUES (?, ?)", [properties, timestamp]);
      return showLogs(setResults);
    });
  };

  define("db", {
    spanishLog: spanishLog,
    showLogs: showLogs,
    resultsFromResultSet: resultsFromResultSet
  });

}).call(this);
